<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Login Token | PixlMuse AI</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #1e1e2f, #2a2a3d);
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
    }

    .login-container {
      background-color: #2c2c3e;
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
      width: 100%;
      max-width: 380px;
      text-align: center;
    }

    h2 {
      margin-bottom: 1rem;
      font-weight: 600;
    }

    input {
      width: 100%;
      padding: 0.75rem;
      margin: 1rem 0;
      border: none;
      border-radius: 6px;
      font-size: 1rem;
    }

    button {
      width: 100%;
      padding: 0.75rem;
      background-color: #00d1b2;
      color: #fff;
      font-weight: 600;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    button:hover {
      background-color: #00bfa3;
    }

    #result {
      margin-top: 1rem;
      padding: 1rem;
      background-color: #1e1e2f;
      border-left: 4px solid #00d1b2;
      border-radius: 6px;
      text-align: left;
      display: none;
    }

    .error {
      color: #ff6b6b;
      margin-top: 1rem;
    }

    .success {
      color: #00d1b2;
    }

    #infoBox {
      margin-top: 1rem;
      padding: 1rem;
      background-color: #223;
      border-left: 4px solid #4fc3f7;
      border-radius: 6px;
      color: #b3e5fc;
      display: none;
    }

    .contact-box {
      margin-top: 1.5rem;
    }

    .contact-icons {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-top: 0.5rem;
    }

    .contact-icons a {
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      background-color: #444;
      text-decoration: none;
      transition: transform 0.2s ease;
    }

    .contact-icons a:hover {
      transform: scale(1.1);
    }

    footer {
      margin-top: 2rem;
      font-size: 0.9rem;
      color: #999;
    }


  
  </style>
</head>
<body>
  <div class="login-container">
    <h2>Login dengan Token</h2>
    <input type="password" id="tokenInput" placeholder="Masukkan token Anda">
    <button onclick="login()">Masuk</button>
    <div id="result"></div>
    <div id="error" class="error"></div>
    <div id="infoBox">Selamat datang! Silakan login dengan token yang valid.</div>

    <div class="contact-box">
      <p>Butuh bantuan? Hubungi admin:</p>
      <div class="contact-icons">
        <!-- WhatsApp Icon -->
        <a href="https://wa.me/6285117042204" target="_blank" style="background-color:#25D366;">
          <svg xmlns="http://www.w3.org/2000/svg" fill="white" height="24" viewBox="0 0 24 24" width="24">
            <path d="M12 2C6.5 2 2 6.5 2 12c0 1.9.5 3.6 1.4 5.1L2 22l5-1.3C8.5 21.5 10.2 22 12 22c5.5 0 10-4.5 10-10S17.5 2 12 2zm.1 17.9c-1.6 0-3.1-.4-4.5-1.2l-.3-.2-3 0.8.8-2.9-.2-.3C4 15.2 3.6 13.6 3.6 12c0-4.7 3.8-8.5 8.5-8.5 2.3 0 4.4.9 6 2.5 1.6 1.6 2.5 3.7 2.5 6s-.9 4.4-2.5 6c-1.6 1.6-3.7 2.5-6 2.5zm4.7-6.7c-.3-.2-1.8-.9-2-.9-.3-.1-.5-.2-.7.2-.2.3-.8.9-1 1-.2.1-.4.1-.6 0-.3-.1-1.2-.4-2.3-1.5-.8-.8-1.3-1.8-1.4-2.1-.1-.2 0-.4.1-.6.1-.1.3-.4.4-.6.1-.2.1-.3.2-.5.1-.2 0-.4 0-.6s-.5-1.2-.7-1.6c-.2-.4-.4-.3-.6-.3h-.5c-.2 0-.5.1-.7.4s-1 1-1 2.5 1.1 2.9 1.3 3.1c.2.2 2.2 3.4 5.4 4.5.8.3 1.4.5 1.9.6.8.1 1.5.1 2 .1.6 0 1.8-.2 2.1-.8.3-.6.3-1.1.2-1.2 0-.2-.3-.3-.6-.5z"/>
          </svg>
        </a>
        <!-- Telegram Icon -->
        <a href="https://t.me/piccapixie" target="_blank" style="background-color:#0088cc;">
          <svg xmlns="http://www.w3.org/2000/svg" fill="white" height="24" viewBox="0 0 24 24" width="24">
            <path d="M9.036 15.783l-.375 3.924c.537 0 .769-.232 1.049-.511l2.512-2.376 5.205 3.81c.953.526 1.636.25 1.872-.882l3.4-15.897c.347-1.63-.57-2.268-1.62-1.88L1.81 10.44c-1.55.605-1.531 1.474-.266 1.86l4.588 1.432L18.112 5.92c.663-.447 1.268-.2.77.288L9.036 15.783z"/>
          </svg>
        </a>
      </div>
    </div>
  </div>

  <script>
    async function login() {
      const token = document.getElementById("tokenInput").value.trim();
      const resultDiv = document.getElementById("result");
      const errorDiv = document.getElementById("error");

      resultDiv.style.display = "none";
      errorDiv.textContent = "";

      if (!token) {
        errorDiv.textContent = "Token tidak boleh kosong";
        return;
      }

      try {
        const res = await fetch(`https://wuszigmegagdwlbjftpm.supabase.co/rest/v1/access_key?token=eq.${token}&select=*`, {
          headers: {
             apikey: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind1c3ppZ21lZ2FnZHdsYmpmdHBtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDcwMDM4MzIsImV4cCI6MjA2MjU3OTgzMn0.QNbieip8O2I4fjkcS6DtS13jgmZC87uov4AjICuvELU',
            Authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind1c3ppZ21lZ2FnZHdsYmpmdHBtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDcwMDM4MzIsImV4cCI6MjA2MjU3OTgzMn0.QNbieip8O2I4fjkcS6DtS13jgmZC87uov4AjICuvELU'
          }
        });

        const data = await res.json();

        if (data && data.length > 0) {
          const tokenData = data[0];

          if (tokenData.is_used) {
            errorDiv.textContent = "Token sudah digunakan";
            return;
          }

          const now = new Date();
          const expiryDate = new Date(tokenData.expires_at);
          if (now > expiryDate) {
            errorDiv.textContent = "Token sudah kadaluarsa";
            return;
          }

          sessionStorage.setItem('tokenData', JSON.stringify(tokenData));
          resultDiv.style.display = "block";
          resultDiv.classList.add('success');
          resultDiv.textContent = "Login berhasil! Anda akan diarahkan ke dashboard...";
          window.location.href = `dasboard.html?token=${encodeURIComponent(token)}`;
        } else {
          errorDiv.textContent = "Token tidak valid";
        }
      } catch (err) {
        console.error("Error:", err);
        errorDiv.textContent = "Terjadi kesalahan saat memverifikasi token";
      }
    }

    document.getElementById("tokenInput").addEventListener("keypress", function(event) {
      if (event.key === "Enter") {
        event.preventDefault();
        login();
      }
    });
  </script>

 
  <footer>
    &copy; 2025 PixlMuse AI. All rights reserved.
  </footer>
</body>
</html>
